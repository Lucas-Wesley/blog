---
title: "Clean Architecture: Testing com Ports and Adapters (Parte 26)"
date: "2025-07-03 14:00"
status: "published"
description: "Aprenda a testar aplicações construídas com Clean Architecture e Arquitetura Hexagonal: explore estratégias de testes unitários para o core e testes de integração para os adaptadores, garantindo a robustez e a manutenibilidade do seu software."
autor: "Lucas Wesley Moreira Tinta"
category: "Clean Architecture"
slug: "clean-architecture-testing-ports-adapters"
tags: ["Clean Architecture", "Testes", "Ports and Adapters", "Arquitetura Hexagonal", "Testes Unitários", "Testes de Integração"]
---

Clean Architecture e Arquitetura Hexagonal (também conhecida como Ports and Adapters) são projetadas para criar aplicações altamente testáveis, separando a lógica de negócio central de preocupações externas como bancos de dados, UI e serviços de terceiros. Essa separação permite testes focados e eficientes em diferentes camadas da aplicação.

### Princípios Gerais de Teste

Ambas as arquiteturas enfatizam o desacoplamento da lógica de negócio (o "Hexágono" ou "Application Core") dos detalhes de infraestrutura. Isso significa:
*   **Isolamento:** O core da aplicação pode ser testado isoladamente do mundo externo.
*   **Inversão de Dependência:** As dependências fluem das camadas externas (adaptadores, frameworks) para as camadas internas (lógica de negócio central), garantindo que o core permaneça independente de tecnologias específicas.
*   **Test Doubles:** Mocks, stubs e fakes são extensivamente usados para substituir dependências externas durante os testes, tornando os testes mais rápidos e confiáveis.

### Testando o Core (Ports)

O "core" da aplicação (frequentemente referido como camada de domínio, casos de uso ou o hexágono) contém as regras e a lógica de negócio essenciais.

*   **Foco:** Testes unitários para o core focam em verificar a lógica de negócio e os casos de uso.
*   **Ports como Interfaces:** O core define "ports" como interfaces que representam suas interações com o mundo exterior. Estes são contratos para o que o core precisa ou fornece.
*   **Mocking de Driven Ports:** Ao testar o core, quaisquer "driven ports" (interfaces que o core usa para interagir com serviços externos, como uma interface de repositório) são substituídos por test doubles (fakes ou mocks). Isso permite que a lógica do core seja testada sem chamadas reais a bancos de dados ou requisições a APIs externas.
*   **Driving Ports:** Os próprios casos de uso podem ser considerados "ports de entrada". Os testes podem invocar diretamente esses casos de uso através de um adaptador de teste, simulando como um sistema externo interagiria com a aplicação.
*   **Benefícios:** Essa abordagem fornece feedback rápido sobre a correção da lógica de negócio e garante que ela esteja livre de preocupações de infraestrutura.

### Testando Adaptadores

Adaptadores são as implementações concretas das portas, conectando o core ao mundo externo (por exemplo, um adaptador de banco de dados, um adaptador de API REST, um adaptador de UI).

*   **Testes Unitários de Adaptadores:** Adaptadores podem ser testados unitariamente para garantir que eles lidam corretamente com transformações de dados e injeção de dependência. As dependências dentro do adaptador podem ser mockadas para isolar sua lógica específica.
*   **Testes de Integração Restritos:** Esses testes são usados para verificar a interação do adaptador com sua tecnologia específica. Por exemplo, um adaptador de banco de dados pode ser testado contra um banco de dados em memória ou um banco de dados de teste dedicado.
*   **Foco:** O objetivo é confirmar que o adaptador traduz corretamente os dados entre os objetos de domínio do core e o formato do sistema externo, e que ele interage com o sistema externo conforme o esperado.
*   **Tipos de Adaptadores e Testes:**
    *   **Driving Adapters (Adaptadores Primários):** Estes são os pontos de entrada na aplicação (por exemplo, um controlador REST, um comando CLI). Testes de integração para esses adaptadores envolveriam o envio de requisições a eles e a verificação das respostas, frequentemente com o core da aplicação mockado ou usando implementações em memória para driven ports.
    *   **Driven Adapters (Adaptadores Secundários):** Estas são implementações que o core usa para interagir com sistemas externos (por exemplo, um repositório de banco de dados, um cliente de API externa). Testes de integração para esses adaptadores envolveriam a configuração do sistema externo real (ou uma versão de teste dele) e a verificação das operações de leitura/escrita do adaptador.
*   **Testes de Contrato:** Para adaptadores que interagem com serviços externos (por exemplo, consumindo uma API de terceiros ou fornecendo uma API), o teste de contrato pode ser empregado para garantir que o adaptador adere ao contrato acordado com o sistema externo.

Ao seguir essas estratégias de teste, a Clean Architecture e a Arquitetura Hexagonal promovem uma base de código robusta, mantenível e facilmente testável, onde as mudanças em uma camada têm impacto mínimo nas outras.

---

+++start+++

## Anterior
[Clean Architecture: Implementando Adapters eficazes (Parte 25)](25.clean-architecture-implementing-adapters.md)

## Próximo
[Clean Architecture: Hexagonal Architecture: Uma implementação de Clean Architecture (Parte 27)](27.clean-architecture-hexagonal-architecture.md)

+++end+++